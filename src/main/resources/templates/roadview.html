<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도로명 조회</title>
    <script>
        async function fetchRoadData() {
            const roadName = document.getElementById('roadName').value;
            if (!roadName) {
                alert('도로명을 입력해주세요.');
                return;
            }

            try {
                const response = await fetch(`/search?roadName=${encodeURIComponent(roadName)}`);
                console.log('Response status:', response.status); // 추가

                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }

                const text = await response.text();
                console.log('Response text:', text); // 추가

                if (!text || text === '{}') {
                    displayNoData();
                } else {
                    console.log('Congestion data:', text); // 추가
                    displayData(text);
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                alert('데이터를 조회하는 중 오류가 발생했습니다.');
            }
        }

        function displayNoData() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>조회된 도로명 정보가 없습니다.</p>';
        }

        function displayData(data) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = ''; // Clear previous results

            const ul = document.createElement('ul');
            const li = document.createElement('li');
            li.textContent = `혼잡도: ${data}`;
            ul.appendChild(li);

            resultDiv.appendChild(ul);
        }
    </script>
</head>
<body>
<h1>도로명 조회</h1>
<input type="text" id="roadName" placeholder="도로명을 입력하세요">
<button onclick="fetchRoadData()">조회</button>
<div id="result"></div>
</body>
</html>
